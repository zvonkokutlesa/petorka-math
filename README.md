# Petorka Math

A children's educational game (React + Vite + TypeScript), ready for GitHub Pages.

## Local Development

```bash
npm install
npm run dev
```

## Scripts

- `npm run dev` - starts the local development server
- `npm run build` - runs TypeScript build and Vite build
- `npm run preview` - starts a local preview of the production build

## Build and Deploy

### GitHub Pages

1. In `Settings -> Pages`, select `GitHub Actions`.
2. Push to `main` to trigger `.github/workflows/deploy.yml`.
3. The workflow builds the app and deploys the `dist` folder.

## Game Mechanics and Rules

### Match Objective

- Open all 10 doors.
- Doors are split into 5 math doors and 5 language doors.
- As soon as all doors are open, the game enters the victory state.

### Map and Entities

- The board size is 20 x 12 tiles.
- One tile is 40 px, so the total playable area is 800 x 480 px.
- The player and wolf move only inside board boundaries.
- The map contains lakes (deadly zones), paths, and trees.
- Trees and paths are visual elements and do not block movement.

### Controls

- Desktop: arrow keys (`ArrowUp`, `ArrowDown`, `ArrowLeft`, `ArrowRight`).
- Mobile/tablet: on-screen D-pad (shown on devices with coarse pointers).
- Holding a key or button means continuous movement.
- When a task modal or Game Over modal is open, movement is paused.

### Player Movement

- Player speed is 160 px/s.
- Position is updated in the `requestAnimationFrame` loop.
- Movement is clamped to board boundaries.

### Wolf (AI Behavior)

- The wolf has two modes: `wander` and `chase`.
- Chase mode is triggered when distance to the player is below 150 px.
- In chase mode, the wolf moves directly toward the player.
- In wander mode, the wolf moves toward a random target and picks a new one when close.
- Wolf speed is 80 px/s in both modes.
- Player-wolf contact causes an instant defeat.

### Doors and Tasks

- A door activates when the player gets close to the center of a closed door (radius ~28 px).
- While a task is open, both player and wolf are frozen.
- A door is marked open only after a correct answer.

### Math Tasks

- The operator is random: `+` or `-`.
- Operands are generated so the result stays within the 0..100 range.
- For `-` tasks, results are always non-negative.
- The answer is entered in an input and confirmed with `Check` or Enter.

### Language Tasks (b/d Focus)

- Two words are shown: one correct and one incorrect.
- Word pairs are predefined in code.
- Option order is randomized.
- A correct choice opens the door.

### Scoring

- Correct answer: `+10`.
- Incorrect answer: `-10`.
- Score can go below zero.
- Every new wrong attempt deducts points again.
- Closing the task modal does not change score and does not open the door.

### End Conditions

- Defeat: the player enters a lake.
- Defeat: the wolf touches the player.
- Victory: all doors are opened.

### Restart Logic

- The `Restart` button resets score to 0.
- All doors return to the closed state.
- Player and wolf return to starting positions.
- Active task and game-over states are cleared.

### Audio and Feedback

- Background music is enabled by default and can be toggled (`Music: On/Off`).
- Sound effects exist for: correct answer, incorrect answer, victory, and defeat.
- The favicon is updated dynamically (mini indicator for player/wolf/task/game-over state).

## AI Instructions

### Goal

Maintain and improve the game without regressions in core mechanics.

### Stack and Key Files

- `src/App.tsx` - main game logic (state, movement, tasks, collisions)
- `src/styles.css` - all styles and responsive behavior
- `src/main.tsx` - React app mount point
- `vite.config.ts` - build configuration
- `dist/` - build output (do not edit manually)

### Working Rules for AI Agents

1. Read relevant files before making changes.
2. Make minimal, targeted changes without unnecessary refactors.
3. Do not change core game rules unless explicitly requested.
4. Do not edit files in `dist/` manually; they are generated by the build.
5. Run `npm run build` after every change.
6. In the report, state what changed and how it was validated.

### Quick Checklist Before Handover

- [ ] `npm run build` passes without errors
- [ ] The app starts with `npm run dev`
- [ ] No manual edits in `dist/`
